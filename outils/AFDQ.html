<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4Safe+ - Test d'Attention au Volant</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.plotly.com/plotly-latest.min.js"></script>
<style>
  body { font-family: 'Inter', sans-serif; background: #f9fafb; }
  .logo-plus { background-color: #28a745; color: white; width: 22px; height: 22px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; margin-left: 2px; }
  .app-card { background:#e0f2fe; border-left:4px solid #3b82f6; padding:1rem; border-radius:0.75rem; cursor:pointer; transition:0.3s; }
  .app-card:hover { background:#bfdbfe; }
</style>
</head>
<body class="p-6">

<!-- HEADER -->
<header class="flex justify-between items-center mb-8">
  <a href="/index.html" class="flex items-center gap-2 text-2xl font-bold text-blue-700">
    4Safe<span class="logo-plus">+</span>
  </a>
  <a href="/index.html" class="text-sm text-blue-600 hover:underline">üè† Retour accueil</a>
</header>

<!-- TITRE -->
<div class="text-center mb-8">
  <h1 class="text-3xl font-bold text-blue-700">Test d'Attention au Volant</h1>
  <p class="text-gray-600 mt-2">D√©couvrez votre point faible principal et recevez une strat√©gie personnalis√©e avec l‚Äôapplication 4Safe<span class="logo-plus">+</span>.</p>
</div>

<!-- FORM -->
<main class="max-w-3xl mx-auto space-y-6">
  <form id="attentionForm" class="space-y-4">
    <div class="bg-white p-4 rounded-lg shadow">1. Avez-vous du mal √† rester concentr√© ? 
      <select name="q1" class="w-full mt-2 p-2 border rounded"><option>Jamais</option><option>Rarement</option><option>Parfois</option><option>Souvent</option></select>
    </div>
    <!-- autres questions comme avant -->
    <div class="text-center">
      <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg">Voir mon r√©sultat</button>
    </div>
  </form>

  <!-- Sch√©ma 3D -->
  <div id="result3D" class="mt-8 h-80"></div>

  <!-- R√©sultat personnalis√© -->
  <div id="resultText" class="mt-6 text-center text-lg font-semibold text-blue-700"></div>

  <!-- Encadr√© App -->
  <div id="appBox" class="app-card mt-6 text-center hidden">
    <p class="font-semibold">Activez votre strat√©gie personnalis√©e dans l‚Äôapp 4Safe<span class="logo-plus">+</span> :</p>
    <div class="flex justify-center gap-4 mt-2">
      <a href="https://play.google.com/store" target="_blank"><img src="/images/googleplay.png" alt="Google Play" class="h-10"></a>
      <a href="https://www.apple.com/app-store/" target="_blank"><img src="/images/appstore.png" alt="App Store" class="h-10"></a>
    </div>
  </div>
</main>

<script>
document.getElementById('attentionForm').addEventListener('submit', function(e){
  e.preventDefault();

  // Exemple r√©sultats
  const scores = [2, 3, 1, 2, 0]; 
  const labels = ["Concentration","Distraction mentale","Fatigue","Distractions externes","Jugement vitesse"];
  const strategies = [
    "Travaillez vos capacit√©s attentionnelles avec des micro-pauses.",
    "Pratiquez des techniques de m√©ditation active.",
    "√âvaluez votre niveau de fatigue avant la route.",
    "R√©duisez les distractions externes.",
    "Am√©liorez votre estimation des vitesses avec des exercices visuels."
  ];

  const maxIndex = scores.indexOf(Math.max(...scores));

  // Graphique 3D (Plotly)
  const data = [{
    type: 'bar3d', // hack avec plotly -> utiliser bar avec 3D layout
    x: [labels[maxIndex]], y: ["Profil dominant"], z: [scores[maxIndex]],
    type: 'bar',
    marker: {color: 'rgba(59,130,246,0.8)'}
  }];

  Plotly.newPlot('result3D', data, {margin:{t:20}, scene:{zaxis:{range:[0,3]}}});

  document.getElementById('resultText').innerHTML = 
    `Votre point faible principal est : <strong>${labels[maxIndex]}</strong><br>${strategies[maxIndex]}`;

  document.getElementById('appBox').classList.remove('hidden');
});
</script>
</body>
</html>
